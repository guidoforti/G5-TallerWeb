<!DOCTYPE HTML>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/fragments :: head('UnRumbo - Home')">
    <th:block th:fragment="extra">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
        <style>
            .btn-dark {
                background-color: #4E3D2F !important;
                border-color: #4E3D2F !important;
            }
        </style>
    </th:block>
</head>

<body>
<nav th:replace="fragments/navbar_conductor :: navbar"></nav>

<main role="main" class="container" style="margin-top: 120px; margin-bottom: 50px;">
    <div class="row justify-content-center">
        <div class="col-md-10 col-lg-10">

            <div class="row g-4 align-items-stretch mb-4">

                <div class="col-lg-6 col-md-12 d-flex">
                    <div class="card shadow-lg border-0 w-100 rounded-4 p-4" style="background-color: #ffffff;">
                        <div class="card-body text-center d-flex flex-column justify-content-between">

                            <h4 class="fw-bold text-dark mb-4">
                                ¬°Bienvenido, <span th:text="${nombreConductor}">Conductor</span>! üöó
                            </h4>

                            <div class="mb-4">
                                <img th:src="@{/img/ruta.jpg}" alt="Comunidad de carpooling en carretera" class="img-fluid rounded shadow-sm mb-3" style="max-height: 200px; object-fit: cover; width: 100%;">
                                <p class="lead fw-bold mb-1" style="color: #E16A3D;">
                                    Public√° tu pr√≥ximo viaje.
                                </p>
                                <p class="text-muted small">Ganancias y comodidad garantizadas.</p>
                            </div>

                            <a th:href="@{/viaje/publicar}" id="btn-publicar-viaje" class="btn btn-primary w-100 fw-bold btn-lg">
                                <i class="fas fa-route me-2"></i> Publicar Viaje
                            </a>
                        </div>
                    </div>
                </div>

                <div class="col-lg-6 col-md-12 d-flex">
                    <div class="card shadow-lg border-0 w-100 rounded-4 p-4" style="background-color: #ffffff;">
                        <div class="card-body d-flex flex-column">

                            <h5 class="fw-bold text-start mb-3" style="color: #4E3D2F;">Mi Gesti√≥n</h5>

                            <a th:href="@{/viaje/listar}" id="btn-mis-viajes" class="btn btn-dark w-100 fw-bold">
                                <i class="fas fa-list-alt me-2"></i> Mis Viajes
                            </a>
                            <p class="text-muted small text-center mt-1 mb-3">Administr√° tus viajes y segu√≠ el estado.</p>

                            <a th:href="@{/reserva/misReservas}" id="btn-ver-reservas" class="btn btn-dark w-100 fw-bold">
                                <i class="fas fa-users-cog me-2"></i> Gestionar Reservas
                            </a>
                            <p class="text-muted small text-center mt-1 mb-3">Acept√° o rechaz√° solicitudes de viajeros.</p>

                            <a th:href="@{/vehiculos/listarVehiculos}" id="btn-ver-vehiculos" class="btn btn-dark w-100 fw-bold">
                                <i class="fas fa-car me-2"></i> Mis Veh√≠culos
                            </a>
                            <p class="text-muted small text-center mt-1 mb-4">Manten√© tu flota actualizada.</p>

                            <div class="mt-auto pt-3 border-top">
                                <a th:href="@{/logout}" id="btn-cerrar-sesion" class="btn btn-danger w-100 fw-bold btn-lg">
                                    <i class="fas fa-sign-out-alt me-2"></i> Cerrar sesi√≥n
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row g-4">

                <div class="col-lg-6 col-md-12">
                    <div class="card shadow-sm border-0 rounded-4">
                        <div class="card-header fw-bold" style="background-color: #734933; color: white;">
                             <i class="fas fa-tachometer-alt me-2"></i> Viaje Activo (En Curso)
                        </div>
                        <div class="card-body p-3">
                            <div th:if="${viajesEnCurso != null and !viajesEnCurso.isEmpty()}">
                                <div th:with="viaje=${viajesEnCurso[0]}" class="alert alert-warning p-3">
                                    <h5 class="fw-bold mb-1 text-dark">
                                        <i class="fas fa-arrow-right me-1"></i> Viajando a <span th:text="${viaje.destino}"></span>
                                    </h5>
                                    <p class="small mb-2">Salida: <span th:text="${viaje.fechaSalida}"></span></p>
                                    <a th:href="@{/viaje/detalle(id=${viaje.id})}" class="btn btn-sm btn-primary">
                                        Gestionar
                                    </a>
                                </div>
                            </div>
                            <div th:unless="${viajesEnCurso != null and !viajesEnCurso.isEmpty()}" class="text-center py-2">
                                <i class="fas fa-info-circle me-1 text-muted"></i>
                                <p class="small mb-0 text-muted">No tienes viajes activos en este momento.</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-lg-6 col-md-12">
                    <div class="card shadow-sm border-0 rounded-4">
                        <div class="card-header fw-bold" style="background-color: #4E3D2F; color: white;">
                             <i class="fas fa-calendar-alt me-2"></i> Pr√≥ximos Viajes
                        </div>
                        <div class="card-body p-3">
                            <div th:if="${viajesProximos != null and !viajesProximos.isEmpty()}">
                                <ul class="list-group list-group-flush">
                                    <li th:each="viaje : ${viajesProximos}" class="list-group-item d-flex justify-content-between align-items-center p-2">
                                        <div>
                                            <strong th:text="${viaje.origen}">Origen</strong> a 
                                            <span th:text="${viaje.destino}">Destino</span>
                                            <small class="text-muted d-block" th:text="${viaje.fechaSalida}"></small>
                                        </div>
                                        <a th:href="@{/viaje/detalle(id=${viaje.id})}" class="btn btn-sm btn-info">
                                            Detalle
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            <div th:unless="${viajesProximos != null and !viajesProximos.isEmpty()}" class="text-center py-2">
                                <i class="fas fa-info-circle me-1 text-muted"></i>
                                <p class="small mb-0 text-muted">No tienes viajes programados pr√≥ximamente.</p>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            
        </div>
    </div>
</main>
<div th:replace="fragments/fragments :: footer"></div>
<script th:src="@{/webjars/bootstrap/5.2.0/js/bootstrap.bundle.min.js}"></script>
<th:block th:replace="fragments/fragments :: scripts-websocket"></th:block>
</body>
</html>
