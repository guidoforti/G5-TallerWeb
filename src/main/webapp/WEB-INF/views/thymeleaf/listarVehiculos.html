<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/fragments :: head('UnRumbo - Mis Vehículos')">
    <th:block th:fragment="extra">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
        <style>
            /* [Estilos de Tabla] -> Complementan new-main.css */
            .table-header-custom th {
                background-color: #734933; /* Marrón Medio (Coffee) */
                color: white;
                font-weight: 700;
                vertical-align: middle;
            }
            .table-striped > tbody > tr:nth-of-type(odd) {
                background-color: #FFFFFF; /* Blanco */
            }
            .table-striped > tbody > tr:nth-of-type(even) {
                background-color: #FFF6F0; /* Crema suave */
            }
            .badge-verificado {
                background-color: #44806A; /* Verde Cálido */
                color: white;
            }
            .badge-pendiente {
                background-color: #FFC107; /* Amarillo Advertencia */
                color: #333333;
            }
        </style>
    </th:block>
</head>

<body>
<nav th:replace="fragments/navbar_conductor :: navbar"></nav>

<main role="main" class="container" style="margin-top: 120px;">
    <h3 class="fw-bold text-center mb-4" style="color: #E16A3D;">
        <i class="bi bi-car-front-fill me-2"></i> Mis Vehículos Registrados
    </h3>

    <div class="mb-4 text-end">
        <a id="btn-registrar-vehiculo" th:href="@{/vehiculos/registrar}" class="btn btn-primary fw-bold">
            <i class="bi bi-plus-circle me-2"></i> Registrar Nuevo Vehículo
        </a>
    </div>

    <div th:if="${error}" class="alert alert-danger" role="alert" th:text="${error}"></div>
    <div th:if="${mensaje}" class="alert alert-success" role="alert" th:text="${mensaje}"></div>

    <div th:if="${#lists.isEmpty(listaVehiculos)}" class="alert alert-info text-center">
        Aún no tienes vehículos registrados. Utiliza el botón superior para agregar uno.
    </div>

    <div th:unless="${#lists.isEmpty(listaVehiculos)}" class="card shadow-sm">
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-striped table-hover mb-0">
                    <thead class="table-header-custom">
                    <tr>
                        <th>Patente</th>
                        <th>Modelo y Año</th>
                        <th>Asientos Totales</th>
                        <th>Verificación</th>
                        <th class="text-center">Acciones</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="vehiculo : ${listaVehiculos}">

                        <td class="fw-bold" th:text="${vehiculo.patente}"></td>

                        <td>
                            <span th:text="${vehiculo.modelo}"></span> (<span th:text="${vehiculo.anio}"></span>)
                        </td>

                        <td><span th:text="${vehiculo.asientosTotales}"></span></td>

                        <td>
                            <span th:if="${vehiculo.estadoVerificacion == 'VERIFICADO'}"
                                  class="badge badge-verificado"> <i class="bi bi-check-circle me-1"></i> Verificado
                            </span>
                            <span th:if="${vehiculo.estadoVerificacion == 'PENDIENTE'}"
                                  class="badge badge-pendiente"> <i class="bi bi-clock me-1"></i> Pendiente
                             </span>
                            <span th:if="${vehiculo.estadoVerificacion == 'DESACTIVADO'}"
                                  class="badge bg-secondary"> <i class="bi bi-slash-circle me-1"></i> Baja
                             </span>
                        </td>

                        <td class="text-center text-nowrap">
                            <th:block th:if="${vehiculo.estadoVerificacion != T(com.tallerwebi.dominio.Enums.EstadoVerificacion).DESACTIVADO}">
                                <a th:href="@{/vehiculos/desactivar/{id}(id=${vehiculo.id})}"
                                   class="btn btn-sm btn-danger fw-bold">
                                    <i class="bi bi-shield-slash"></i> Desactivar
                                </a>
                            </th:block>

                            <th:block th:if="${vehiculo.estadoVerificacion == T(com.tallerwebi.dominio.Enums.EstadoVerificacion).DESACTIVADO}">
                                <span class="badge bg-secondary fw-bold">
                                    <i class="bi bi-slash-circle me-1"></i> Baja
                                </span>
                            </th:block>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="mt-4 text-center">
        <a th:href="@{/conductor/home}" class="btn btn-outline-secondary fw-bold">
            <i class="bi bi-house-door-fill me-2"></i> Volver al Inicio
        </a>
    </div>
</main>
<div th:replace="fragments/fragments :: footer"></div>
<script th:src="@{/webjars/bootstrap/5.2.0/js/bootstrap.bundle.min.js}"></script>
<th:block th:replace="fragments/fragments :: scripts-websocket"></th:block>
</body>
</html>