<!DOCTYPE HTML>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/fragments :: head('UnRumbo - Registro')">
    <th:block th:fragment="extra">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
        <style>
            :root {
                --color-primary: #E16A3D;
                --color-taupe: #4E3D2F;
                --color-coffee: #734933;
                --color-success-warm: #44806A;
            }
            .btn-unrumbo {
                background-color: var(--color-primary) !important;
                border-color: var(--color-primary) !important;
                color: white !important;
            }
            .btn-unrumbo:hover {
                background-color: #cf5930 !important;
                border-color: #cf5930 !important;
            }
            /* Estilos para la imagen de concepto en desktop */
            .bg-image-container {
                background-color: #f7f7f7;
                border-radius: 0.5rem;
                overflow: hidden;
                position: relative; /* Para posicionar texto sobre la imagen */
            }
            .registration-card {
                /* Usar g-0 para que las columnas de la fila interior se peguen */
                padding: 0;
            }
            .h6-conductor { color: var(--color-coffee); } /* Marrón medio para conductor */
            .h6-viajero { color: var(--color-success-warm); } /* Verde cálido para viajero */
            .text-unrumbo-link {
                color: var(--color-primary) !important;
                text-decoration: none;
            }
            .text-unrumbo-link:hover {
                color: #cf5930 !important;
                text-decoration: underline;
            }
        </style>
    </th:block>
</head>

<body>
<nav th:replace="fragments/navbar_anonimo :: navbar"></nav>

<main role="main" class="container" style="margin-top: 120px;">
    <div class="row justify-content-center">
        <div class="col-lg-10 col-md-10"> <div class="card shadow-lg border-0 registration-card">
                <div class="row g-0 align-items-stretch">
                    
                    <div class="col-lg-5 d-none d-lg-block bg-image-container">
                        <img th:src="@{/img/amigosRuta.jpg}" alt="Comunidad viajera compartiendo viajes" class="img-fluid h-100" style="object-fit: cover;">
                        <div class="position-absolute p-4 text-white" style="top: 0; background: rgba(0, 0, 0, 0.4); width: 100%;">
                            <h3 class="fw-bold mb-1">Viajá en comunidad</h3>
                            <p class="small">Registrándote accedés a una red de viajes compartidos segura y eficiente.</p>
                        </div>
                    </div>
                    
                    <div class="col-lg-7">
                        <div class="card-body p-4">
                            <div class="text-center mb-4">
                                <h4 class="fw-bold" style="color: var(--color-taupe);">
                                    <i class="fas fa-user-plus me-2"></i> Crea tu Cuenta
                                </h4>
                                <p class="text-muted">Completa tus datos y selecciona tu rol</p>
                            </div>

                            <form th:action="@{/validar-registro}" method="POST" th:object="${datosRegistro}" enctype="multipart/form-data">

                                <div class="mb-3">
                                    <label for="rolSeleccionado" class="form-label fw-bold">
                                        <i class="fas fa-user-tag me-1"></i> Registrarme como:
                                    </label>
                                    <select id="rolSeleccionado" th:field="*{rolSeleccionado}" class="form-select" required>
                                        <option value="">Selecciona tu rol</option>
                                        <option value="VIAJERO">Viajero (Pasajero)</option>
                                        <option value="CONDUCTOR">Conductor (Dueño de vehículo)</option>
                                    </select>
                                </div>

                                <hr/>

                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="nombre" class="form-label fw-bold"><i class="fas fa-user me-1"></i> Nombre y Apellido</label>
                                        <input th:field="*{nombre}" id="nombre" type="text" class="form-control" placeholder="Juan Pérez" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="email" class="form-label"><i class="fa-solid fa-envelope"></i> Email</label>
                                        <input th:field="*{email}" id="email" type="email" class="form-control" placeholder="ejemplo@mail.com" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="contrasenia" class="form-label"><i class="fa-solid fa-key"></i> Contraseña</label>
                                        <input th:field="*{contrasenia}" id="contrasenia" type="password" class="form-control" placeholder="********" required>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="fechaNacimiento" class="form-label fw-bold">
                                            <i class="fas fa-calendar-alt me-1"></i> Nacimiento *
                                        </label>
                                        <input th:field="*{fechaNacimiento}" id="fechaNacimiento" type="date" class="form-control" required>
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="fumador" class="form-label fw-bold">
                                            <i class="fas fa-smoking me-1"></i> ¿Es fumador?
                                        </label>
                                        <select th:field="*{fumador}" id="fumador" class="form-select" required>
                                            <option value="false">No</option>
                                            <option value="true">Sí</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="discapacitado" class="form-label fw-bold">
                                            <i class="fas fa-wheelchair me-1"></i> Discapacidad (Opcional)
                                        </label>
                                        <input th:field="*{discapacitado}" id="discapacitado" type="text" class="form-control" placeholder="(ej: movilidad reducida)">
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label for="fotoPerfilUrl" class="form-label fw-bold">
                                        <i class="fas fa-camera me-1"></i> Subir Foto de Perfil (.jpg, .png)
                                    </label>
                                    <input name="fotoPerfil" id="fotoPerfilUrl" type="file" class="form-control" accept="image/*" required>
                                    <small class="form-text text-muted">Tamaño máximo recomendado: 2MB.</small>
                                </div>

                                <hr/>

                                <div id="camposConductor" class="p-3 border rounded mb-3 bg-light" style="border-color: var(--color-coffee) !important;">
                                    <h6 class="fw-bold h6-conductor"><i class="fas fa-car me-2"></i> Datos de Licencia (Solo Conductor)</h6>
                                    <div class="mb-3">
                                        <label for="fechaDeVencimientoLicencia" class="form-label">
                                            <i class="fas fa-calendar-check me-1"></i> Fecha de vencimiento de licencia *
                                        </label>
                                        <input th:field="*{fechaDeVencimientoLicencia}" id="fechaDeVencimientoLicencia" type="date" class="form-control">
                                    </div>
                                </div>

                                <div id="camposViajero" class="p-3 border rounded mb-3 bg-light" style="border-color: var(--color-success-warm) !important; display:none">
                                    <h6 class="fw-bold h6-viajero"><i class="fas fa-hiking me-2"></i> Notas de Viajero</h6>
                                    <p class="text-muted small mb-0">No requiere campos adicionales específicos.</p>
                                </div>


                                <button type="submit" class="btn btn-unrumbo w-100 fw-bold">
                                    <i class="fas fa-paper-plane me-1"></i> Registrarme
                                </button>
                            </form>

                            <div class="text-center mt-3">
                                <a th:href="@{/login}" class="text-unrumbo-link fw-bold">
                                    ¿Ya tenés cuenta? Iniciá sesión
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</main>
<div th:replace="fragments/fragments :: footer"></div>
<script th:src="@{/webjars/bootstrap/5.2.0/js/bootstrap.bundle.min.js}"></script>
<script th:src="@{/js/registroDinamico.js}"></script>
<th:block th:replace="fragments/fragments :: scripts-websocket"></th:block>
</body>
</html>